% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering

\author{}
\date{\vspace{-2.5em}}

\begin{document}

This homework data set depends on this data set:

\url{https://www.kaggle.com/yersever/500-person-gender-height-weight-bodymassindex?select=500_Person_Gender_Height_Weight_Index.csv}

Please submit this homework by creating an RMD file in your project1 git
repo. The RMD should run in the project1 docker environment. You may
need to install the gbm package.

\hypertarget{problem-1}{%
\section{Problem 1:}\label{problem-1}}

Build a glm in R to classifier individuals as either Male or Female
based on their weight and height.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#Load and clean up}
\NormalTok{person.data <-}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\StringTok{"500_Person_Gender_Height_Weight_Index.csv"}\NormalTok{)}
\NormalTok{person.data}\OperatorTok{$}\NormalTok{Gender[person.data}\OperatorTok{$}\NormalTok{Gender }\OperatorTok{==}\StringTok{ 'Female'}\NormalTok{] =}\StringTok{ }\DecValTok{0}
\NormalTok{person.data}\OperatorTok{$}\NormalTok{Gender[person.data}\OperatorTok{$}\NormalTok{Gender }\OperatorTok{==}\StringTok{ 'Male'}\NormalTok{] =}\StringTok{ }\DecValTok{1}
\NormalTok{person.data}\OperatorTok{$}\NormalTok{Gender =}\StringTok{ }\KeywordTok{as.integer}\NormalTok{(person.data}\OperatorTok{$}\NormalTok{Gender)}

\CommentTok{#Train/test split}
\NormalTok{traininds <-}\StringTok{ }\KeywordTok{sort}\NormalTok{(}\KeywordTok{sample}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(person.data), }\KeywordTok{nrow}\NormalTok{(person.data)}\OperatorTok{*}\NormalTok{.}\DecValTok{7}\NormalTok{))}

\NormalTok{train.data <-}\StringTok{ }\NormalTok{person.data[traininds,]}
\NormalTok{test.data <-}\StringTok{ }\NormalTok{person.data[}\OperatorTok{-}\NormalTok{traininds,]}

\NormalTok{fit.model <-}\StringTok{ }\KeywordTok{glm}\NormalTok{(Gender }\OperatorTok{~}\StringTok{ }\NormalTok{Height }\OperatorTok{+}\StringTok{ }\NormalTok{Weight, }\DataTypeTok{data =}\NormalTok{ train.data, }\DataTypeTok{family=}\NormalTok{binomial)}

\KeywordTok{summary}\NormalTok{(fit.model)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = Gender ~ Height + Weight, family = binomial, data = train.data)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -1.243  -1.167  -1.099   1.186   1.260  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(>|z|)
## (Intercept)  9.796e-01  1.150e+00   0.852    0.394
## Height      -5.877e-03  6.473e-03  -0.908    0.364
## Weight      -5.286e-05  3.254e-03  -0.016    0.987
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 485.16  on 349  degrees of freedom
## Residual deviance: 484.33  on 347  degrees of freedom
## AIC: 490.33
## 
## Number of Fisher Scoring iterations: 3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{test.data}\OperatorTok{$}\NormalTok{glmProb <-}\StringTok{ }\KeywordTok{predict}\NormalTok{(fit.model, test.data, }\DataTypeTok{type=}\StringTok{"response"}\NormalTok{)}
\NormalTok{test.data <-}\StringTok{ }\NormalTok{test.data }\OperatorTok{%>%}\StringTok{ }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{glmPred =} \DecValTok{1}\OperatorTok{*}\NormalTok{(glmProb }\OperatorTok{>}\StringTok{ }\FloatTok{.5}\NormalTok{) }\OperatorTok{+}\StringTok{ }\DecValTok{0}\NormalTok{)}
\KeywordTok{confusionMatrix}\NormalTok{(}\KeywordTok{as.factor}\NormalTok{(test.data}\OperatorTok{$}\NormalTok{Gender), }\KeywordTok{as.factor}\NormalTok{(test.data}\OperatorTok{$}\NormalTok{glmPred))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Confusion Matrix and Statistics
## 
##           Reference
## Prediction  0  1
##          0 47 31
##          1 45 27
##                                           
##                Accuracy : 0.4933          
##                  95% CI : (0.4108, 0.5761)
##     No Information Rate : 0.6133          
##     P-Value [Acc > NIR] : 0.9989          
##                                           
##                   Kappa : -0.0226         
##                                           
##  Mcnemar's Test P-Value : 0.1359          
##                                           
##             Sensitivity : 0.5109          
##             Specificity : 0.4655          
##          Pos Pred Value : 0.6026          
##          Neg Pred Value : 0.3750          
##              Prevalence : 0.6133          
##          Detection Rate : 0.3133          
##    Detection Prevalence : 0.5200          
##       Balanced Accuracy : 0.4882          
##                                           
##        'Positive' Class : 0               
## 
\end{verbatim}

What is the accuracy of the model?

Worse than random! 0.44

\hypertarget{problem-2}{%
\section{Problem 2:}\label{problem-2}}

Use the `gbm' package to train a similar model. Don't worry about hyper
parameter tuning for now.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(gbm)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Loaded gbm 2.1.8
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#Train/test split}
\NormalTok{traininds <-}\StringTok{ }\KeywordTok{sort}\NormalTok{(}\KeywordTok{sample}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(person.data), }\KeywordTok{nrow}\NormalTok{(person.data)}\OperatorTok{*}\NormalTok{.}\DecValTok{7}\NormalTok{))}

\NormalTok{fit.model <-}\StringTok{ }\KeywordTok{gbm}\NormalTok{(Gender }\OperatorTok{~}\StringTok{ }\NormalTok{Height }\OperatorTok{+}\StringTok{ }\NormalTok{Weight, }\DataTypeTok{data =}\NormalTok{ train.data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Distribution not specified, assuming bernoulli ...
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#summary(fit.model)}

\NormalTok{test.data}\OperatorTok{$}\NormalTok{gbmProb <-}\StringTok{ }\KeywordTok{predict}\NormalTok{(fit.model, test.data, }\DataTypeTok{type=}\StringTok{"response"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Using 100 trees...
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{test.data <-}\StringTok{ }\NormalTok{test.data }\OperatorTok{%>%}\StringTok{ }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{gbmPred =} \DecValTok{1}\OperatorTok{*}\NormalTok{(gbmProb }\OperatorTok{>}\StringTok{ }\FloatTok{.5}\NormalTok{) }\OperatorTok{+}\StringTok{ }\DecValTok{0}\NormalTok{)}
\NormalTok{caret}\OperatorTok{::}\KeywordTok{confusionMatrix}\NormalTok{(}\KeywordTok{as.factor}\NormalTok{(test.data}\OperatorTok{$}\NormalTok{Gender), }\KeywordTok{as.factor}\NormalTok{(test.data}\OperatorTok{$}\NormalTok{gbmPred))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Confusion Matrix and Statistics
## 
##           Reference
## Prediction  0  1
##          0 49 29
##          1 36 36
##                                           
##                Accuracy : 0.5667          
##                  95% CI : (0.4834, 0.6473)
##     No Information Rate : 0.5667          
##     P-Value [Acc > NIR] : 0.5343          
##                                           
##                   Kappa : 0.1287          
##                                           
##  Mcnemar's Test P-Value : 0.4568          
##                                           
##             Sensitivity : 0.5765          
##             Specificity : 0.5538          
##          Pos Pred Value : 0.6282          
##          Neg Pred Value : 0.5000          
##              Prevalence : 0.5667          
##          Detection Rate : 0.3267          
##    Detection Prevalence : 0.5200          
##       Balanced Accuracy : 0.5652          
##                                           
##        'Positive' Class : 0               
## 
\end{verbatim}

What is the accuracy of the model?

Also bad, 0.5

\hypertarget{problem-3}{%
\section{Problem 3}\label{problem-3}}

Filter the data set so that it contains only 50 Male examples and all
female examples. Create a new model for this data set. What is the F1
Score of the model?

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{males <-}\StringTok{ }\NormalTok{person.data[person.data}\OperatorTok{$}\NormalTok{Gender}\OperatorTok{==}\DecValTok{1}\NormalTok{,]}
\NormalTok{male}\FloatTok{.50}\NormalTok{ <-}\StringTok{ }\NormalTok{males[}\KeywordTok{sample}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(males), }\DecValTok{50}\NormalTok{),]}
\NormalTok{filt.data <-}\StringTok{ }\KeywordTok{rbind}\NormalTok{(male}\FloatTok{.50}\NormalTok{, person.data[person.data}\OperatorTok{$}\NormalTok{Gender}\OperatorTok{==}\DecValTok{0}\NormalTok{,])}

\CommentTok{#Train/test split}
\NormalTok{traininds <-}\StringTok{ }\KeywordTok{sort}\NormalTok{(}\KeywordTok{sample}\NormalTok{(}\KeywordTok{nrow}\NormalTok{(filt.data), }\KeywordTok{nrow}\NormalTok{(filt.data)}\OperatorTok{*}\NormalTok{.}\DecValTok{7}\NormalTok{))}

\NormalTok{fit.model <-}\StringTok{ }\KeywordTok{gbm}\NormalTok{(Gender }\OperatorTok{~}\StringTok{ }\NormalTok{Height }\OperatorTok{+}\StringTok{ }\NormalTok{Weight, }\DataTypeTok{data =}\NormalTok{ train.data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Distribution not specified, assuming bernoulli ...
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#summary(fit.model)}

\NormalTok{test.data}\OperatorTok{$}\NormalTok{gbmProb2 <-}\StringTok{ }\KeywordTok{predict}\NormalTok{(fit.model, test.data, }\DataTypeTok{type=}\StringTok{"response"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Using 100 trees...
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{test.data <-}\StringTok{ }\NormalTok{test.data }\OperatorTok{%>%}\StringTok{ }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{gbmPred2 =} \DecValTok{1}\OperatorTok{*}\NormalTok{(gbmProb2 }\OperatorTok{>}\StringTok{ }\FloatTok{.5}\NormalTok{) }\OperatorTok{+}\StringTok{ }\DecValTok{0}\NormalTok{)}
\KeywordTok{confusionMatrix}\NormalTok{(}\KeywordTok{as.factor}\NormalTok{(test.data}\OperatorTok{$}\NormalTok{Gender), }\KeywordTok{as.factor}\NormalTok{(test.data}\OperatorTok{$}\NormalTok{gbmPred2))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Confusion Matrix and Statistics
## 
##           Reference
## Prediction  0  1
##          0 50 28
##          1 35 37
##                                         
##                Accuracy : 0.58          
##                  95% CI : (0.4968, 0.66)
##     No Information Rate : 0.5667        
##     P-Value [Acc > NIR] : 0.4038        
##                                         
##                   Kappa : 0.1555        
##                                         
##  Mcnemar's Test P-Value : 0.4497        
##                                         
##             Sensitivity : 0.5882        
##             Specificity : 0.5692        
##          Pos Pred Value : 0.6410        
##          Neg Pred Value : 0.5139        
##              Prevalence : 0.5667        
##          Detection Rate : 0.3333        
##    Detection Prevalence : 0.5200        
##       Balanced Accuracy : 0.5787        
##                                         
##        'Positive' Class : 0             
## 
\end{verbatim}

\hypertarget{problem-4}{%
\section{Problem 4}\label{problem-4}}

For the model in the previous example plot an ROC curve. What does this
ROC curve mean?

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(ROCR)}

\NormalTok{pred <-}\StringTok{ }\KeywordTok{prediction}\NormalTok{(test.data}\OperatorTok{$}\NormalTok{gbmPred2, test.data}\OperatorTok{$}\NormalTok{Gender)}
\NormalTok{perf <-}\StringTok{ }\KeywordTok{performance}\NormalTok{(pred, }\StringTok{'tpr'}\NormalTok{, }\StringTok{'fpr'}\NormalTok{)}
\KeywordTok{plot}\NormalTok{(perf, }\DataTypeTok{colorize=}\OtherTok{TRUE}\NormalTok{, }\DataTypeTok{main=}\StringTok{"ROC Curve for Imbalanced Set GBM"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{homework4_files/figure-latex/unnamed-chunk-5-1.pdf}

\hypertarget{problem-5}{%
\section{Problem 5}\label{problem-5}}

Using K-Means, cluster the same data set. Can you identify the clusters
with the known labels? Provide an interpretation of this result.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(factoextra)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pca.fit <-}\StringTok{ }\KeywordTok{prcomp}\NormalTok{(filt.data)}

\KeywordTok{fviz_screeplot}\NormalTok{(pca.fit, }
               \DataTypeTok{addlabels=}\OtherTok{TRUE}\NormalTok{, }
               \DataTypeTok{title=}\StringTok{"PCA of Imbalanced Dataset"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{homework4_files/figure-latex/unnamed-chunk-6-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Well... I suppose we could use just one cluster but that wouldn't be very interesting, now would it? Let's try 2}
\NormalTok{kmeans.fit <-}\StringTok{ }\KeywordTok{kmeans}\NormalTok{(filt.data, }\DecValTok{2}\NormalTok{)}
\KeywordTok{fviz_cluster}\NormalTok{(kmeans.fit, filt.data, }\DataTypeTok{geom=}\StringTok{"point"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{homework4_files/figure-latex/unnamed-chunk-6-2.pdf}

\end{document}
